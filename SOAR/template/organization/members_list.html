<!-- members_list.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Members List - {{ organization.name }}</title>
</head>
<body>
    <h1>Members of {{ organization.name }}</h1>
    
    <form method="GET" action="{% url 'members_list' organization.id %}">
        <input type="search" name="search" value="{{ search_query }}" placeholder="Search by name or email">
        <button type="submit">Search</button>
    </form>
    
    <ul>
        {% for member in members %}
            <li>
                {{ member.name }} - {{ member.email }} - Role: {{ member.role.name }}
                
                {% if user.is_authenticated %}
                    {% with current_member=user.member_set.filter(organization=organization).first %}
                        {% if current_member and current_member.role.name in 'Admin,Officer' %}
                            <form method="POST" action="{% url 'promote_member' organization.id member.id %}" style="display:inline;">
                                {% csrf_token %}
                                <select name="new_role">
                                    {% for role in roles %}
                                        <option value="{{ role.name }}" {% if role.name == member.role.name %}selected{% endif %}>{{ role.name }}</option>
                                    {% endfor %}
                                </select>
                                <button type="submit">Promote</button>
                            </form>
                        {% endif %}
                    {% endwith %}
                {% endif %}
            </li>
        {% endfor %}
    </ul>
    
    <a href="{% url 'org_profile' organization.id %}">Back to Org Profile</a>
</body>
</html>